<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒª</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f5f5;
      padding: 10px;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    nav {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    nav a {
      padding: 10px 20px;
      background-color: #667eea;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    nav a:hover {
      background-color: #764ba2;
    }

    .dashboard {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .card h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 18px;
    }

    .stat-group {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .stat {
      flex: 1;
      text-align: center;
      padding: 10px;
    }

    .stat-label {
      font-size: 12px;
      color: #999;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #333;
    }

    .stat-value.income {
      color: #4CAF50;
    }

    .stat-value.expense {
      color: #f44336;
    }

    .chart-container {
      position: relative;
      height: 300px;
      margin-top: 20px;
    }

    .form-section {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .form-group {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr 1fr auto;
      gap: 10px;
      margin-bottom: 15px;
      align-items: flex-end;
    }

    label {
      display: block;
      font-weight: bold;
      color: #333;
      font-size: 14px;
      margin-bottom: 5px;
    }

    input, select {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      width: 100%;
    }

    button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #45a049;
    }

    .transaction-list {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .transaction-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border-bottom: 1px solid #eee;
      background: #f9f9f9;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .transaction-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .transaction-info {
      flex: 1;
    }

    .transaction-category {
      font-weight: bold;
      color: #333;
      margin-bottom: 5px;
    }

    .transaction-description {
      font-size: 12px;
      color: #999;
    }

    .transaction-amount {
      font-weight: bold;
      font-size: 16px;
      margin-right: 10px;
    }

    .transaction-amount.income {
      color: #4CAF50;
    }

    .transaction-amount.expense {
      color: #f44336;
    }

    .delete-btn {
      background-color: #f44336;
      padding: 5px 10px;
      font-size: 12px;
    }

    .delete-btn:hover {
      background-color: #da190b;
    }

    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }

      .form-group {
        grid-template-columns: 1fr;
      }

      nav {
        flex-direction: column;
      }

      nav a {
        width: 100%;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ’° å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒª</h1>
    <p>æ¯æ—¥ã®åæ”¯ã‚’ç®¡ç†ã—ã¦ã€è³¢ããŠé‡‘ã‚’ä½¿ã„ã¾ã—ã‚‡ã†</p>
  </div>

  <div class="container">
    <nav>
      <a href="index.html">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
      <a href="transaction.html">åæ”¯ç®¡ç†</a>
      <a href="budget.html">äºˆç®—ç®¡ç†</a>
      <a href="goal.html">è²¯é‡‘ç›®æ¨™</a>
      <a href="report.html">ãƒ¬ãƒãƒ¼ãƒˆ</a>
    </nav>

    <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
    <div class="dashboard">
      <div class="card">
        <h2>ğŸ“Š ä»Šæœˆã®åæ”¯</h2>
        <div class="stat-group">
          <div class="stat">
            <div class="stat-label">åå…¥</div>
            <div class="stat-value income" id="monthly-income">Â¥0</div>
          </div>
          <div class="stat">
            <div class="stat-label">æ”¯å‡º</div>
            <div class="stat-value expense" id="monthly-expense">Â¥0</div>
          </div>
          <div class="stat">
            <div class="stat-label">æ®‹é¡</div>
            <div class="stat-value" id="monthly-balance">Â¥0</div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="balance-chart"></canvas>
        </div>
      </div>

      <div class="card">
        <h2>ğŸ¯ è²¯é‡‘ç›®æ¨™</h2>
        <div class="stat-group">
          <div class="stat">
            <div class="stat-label">ç›®æ¨™é¡</div>
            <div class="stat-value" id="goal-amount">Â¥0</div>
          </div>
          <div class="stat">
            <div class="stat-label">é€²æ—</div>
            <div class="stat-value" id="goal-progress">0%</div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="goal-chart"></canvas>
        </div>
      </div>
    </div>

    <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="form-section">
      <h2>ğŸ’³ å–å¼•ã‚’è¿½åŠ </h2>
      <form id="transaction-form">
        <div class="form-group">
          <div>
            <label for="type">ã‚¿ã‚¤ãƒ—</label>
            <select id="type" required>
              <option value="income">ğŸ’° åå…¥</option>
              <option value="expense">ğŸ’¸ æ”¯å‡º</option>
            </select>
          </div>
          <div>
            <label for="category">ã‚«ãƒ†ã‚´ãƒª</label>
            <select id="category" required>
              <option value="é£Ÿè²»">ğŸ” é£Ÿè²»</option>
              <option value="äº¤é€šè²»">ğŸš— äº¤é€šè²»</option>
              <option value="å¨¯æ¥½">ğŸ® å¨¯æ¥½</option>
              <option value="çµ¦æ–™">ğŸ’¼ çµ¦æ–™</option>
              <option value="ãã®ä»–">ğŸ“ ãã®ä»–</option>
            </select>
          </div>
          <div>
            <label for="amount">é‡‘é¡</label>
            <input type="number" id="amount" min="0" required>
          </div>
          <div>
            <label for="description">èª¬æ˜</label>
            <input type="text" id="description" required>
          </div>
          <button type="submit">è¿½åŠ </button>
        </div>
      </form>
    </div>

    <!-- å–å¼•å±¥æ­´ -->
    <div class="transaction-list">
      <h2>ğŸ“‹ æœ€è¿‘ã®å–å¼•</h2>
      <div id="transaction-items"></div>
    </div>
  </div>

  <script>
    const transactionForm = document.getElementById('transaction-form');
    const transactionItems = document.getElementById('transaction-items');
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
    let balanceChart = null;
    let goalChart = null;

    // å–å¼•ã‚’è¡¨ç¤º
    function renderTransactions() {
      transactionItems.innerHTML = '';
      const recent = transactions.slice(-10).reverse();
      
      if (recent.length === 0) {
        transactionItems.innerHTML = '<p style="text-align: center; color: #999;">å–å¼•ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }

      recent.forEach((transaction, index) => {
        const originalIndex = transactions.length - 1 - index;
        const item = document.createElement('div');
        item.className = 'transaction-item';
        
        const amountClass = transaction.type === 'income' ? 'income' : 'expense';
        const prefix = transaction.type === 'income' ? '+' : 'âˆ’';
        
        item.innerHTML = `
          <div class="transaction-info">
            <div class="transaction-category">${transaction.category}</div>
            <div class="transaction-description">${transaction.description}</div>
          </div>
          <div class="transaction-amount ${amountClass}">${prefix}Â¥${transaction.amount}</div>
          <button class="delete-btn" onclick="deleteTransaction(${originalIndex})">å‰Šé™¤</button>
        `;
        transactionItems.appendChild(item);
      });
    }

    // çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°
    function updateStats() {
      const today = new Date();
      const currentMonth = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0');
      
      let monthlyIncome = 0;
      let monthlyExpense = 0;

      transactions.forEach(t => {
        const tDate = new Date(t.date || today).toISOString().slice(0, 7);
        if (tDate === currentMonth) {
          if (t.type === 'income') {
            monthlyIncome += parseFloat(t.amount);
          } else {
            monthlyExpense += parseFloat(t.amount);
          }
        }
      });

      const balance = monthlyIncome - monthlyExpense;

      document.getElementById('monthly-income').textContent = 'Â¥' + monthlyIncome.toLocaleString();
      document.getElementById('monthly-expense').textContent = 'Â¥' + monthlyExpense.toLocaleString();
      document.getElementById('monthly-balance').textContent = 'Â¥' + balance.toLocaleString();
      document.getElementById('monthly-balance').style.color = balance >= 0 ? '#4CAF50' : '#f44336';

      updateCharts(monthlyIncome, monthlyExpense);
    }

    // ã‚°ãƒ©ãƒ•ã‚’æ›´æ–°
    function updateCharts(income, expense) {
      const ctx = document.getElementById('balance-chart').getContext('2d');
      
      if (balanceChart) {
        balanceChart.destroy();
      }

      balanceChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['åå…¥', 'æ”¯å‡º'],
          datasets: [{
            data: [income, expense],
            backgroundColor: ['#4CAF50', '#f44336'],
            borderColor: ['#45a049', '#da190b'],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }

    // è²¯é‡‘ç›®æ¨™ã®ã‚°ãƒ©ãƒ•ã‚’æ›´æ–°
    function updateGoalChart() {
      const goals = JSON.parse(localStorage.getItem('goals')) || [];
      const totalGoal = goals.reduce((sum, g) => sum + parseFloat(g.amount), 0);
      
      const today = new Date();
      const currentMonth = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0');
      
      let monthlySavings = 0;
      transactions.forEach(t => {
        const tDate = new Date(t.date || today).toISOString().slice(0, 7);
        if (tDate === currentMonth && t.type === 'income') {
          monthlySavings += parseFloat(t.amount);
        }
      });

      const progress = totalGoal > 0 ? Math.min((monthlySavings / totalGoal) * 100, 100) : 0;

      document.getElementById('goal-amount').textContent = 'Â¥' + totalGoal.toLocaleString();
      document.getElementById('goal-progress').textContent = Math.round(progress) + '%';

      const ctx = document.getElementById('goal-chart').getContext('2d');
      
      if (goalChart) {
        goalChart.destroy();
      }

      goalChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['é€²æ—'],
          datasets: [{
            label: 'é”æˆåº¦',
            data: [progress],
            backgroundColor: '#667eea',
            borderColor: '#764ba2',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          scales: {
            x: {
              beginAtZero: true,
              max: 100
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
    }

    // å–å¼•ã‚’å‰Šé™¤
    function deleteTransaction(index) {
      transactions.splice(index, 1);
      localStorage.setItem('transactions', JSON.stringify(transactions));
      renderTransactions();
      updateStats();
      updateGoalChart();
    }

    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
    transactionForm.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const type = document.getElementById('type').value;
      const category = document.getElementById('category').value;
      const amount = parseFloat(document.getElementById('amount').value);
      const description = document.getElementById('description').value;
      const date = new Date().toISOString().split('T')[0];

      transactions.push({ type, category, amount, description, date });
      localStorage.setItem('transactions', JSON.stringify(transactions));
      
      transactionForm.reset();
      renderTransactions();
      updateStats();
      updateGoalChart();
    });

    // åˆæœŸåŒ–
    renderTransactions();
    updateStats();
    updateGoalChart();
  </script>
</body>
</html>
          <h2>ãƒ¬ãƒãƒ¼ãƒˆ</h2>
          <p>ã‚°ãƒ©ãƒ•ã§æ”¯å‡ºã‚’åˆ†æã—ã€å®¶è¨ˆã®æ”¹å–„ã«å½¹ç«‹ã¦ã¾ã—ã‚‡ã†ã€‚</p>
        </div>
      </div>
    </div>
  </body>
</html>
